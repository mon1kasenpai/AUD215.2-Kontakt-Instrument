on init 

	{General UI Constants}
	declare const $UI_HEIGHT := 350
	declare const $UI_WIDTH := 633
	declare const $Y_OFFSET := 0
	declare const $X_OFFSET := 0
	declare const $UI_COLOUR_HEX := 934d8ddh  {Change this to the 6 character hex number of your chosen colour and leave the 9 at the start and h at the end (eg. 9<hex_code>h).}
	


	{ -- sub snyth stuff -- }

		declare const $SUBSYNTH_GROUP_START := 4

		declare const $SUBSYNTH_GROUP_END := 7

		declare $i
		declare $i2

		declare $KILLSWITCH_USED

		declare ui_wavetable $SubSynthWave 

		declare ui_menu $SubSynthDropdown
		make_persistent($SubSynthDropdown)
		declare $SubSynthDropdownId
		$SubSynthDropdownId := get_ui_id($SubSynthDropdown)

		declare ui_button $SubSynthEnable
		declare $SubSynthEnableId
		make_persistent($SubSynthEnable)
		$SubSynthEnableId := get_ui_id($SubSynthEnable)
		set_control_par($SubSynthEnableId, $CONTROL_PAR_TEXT_ALIGNMENT, 1)

		declare ui_button $CreekEnable
		make_persistent($CreekEnable)
		declare $CreekEnableId
		$CreekEnableId := get_ui_id($CreekEnable)
		set_control_par($CreekEnableId, $CONTROL_PAR_TEXT_ALIGNMENT, 1)
		
		add_menu_item ($SubSynthDropdown, "Sine", 0)
		add_menu_item ($SubSynthDropdown, "Square", 1)
		add_menu_item ($SubSynthDropdown, "Saw", 2)
		add_menu_item ($SubSynthDropdown, "Triangle", 3)
		add_menu_item($SubSynthDropdown, "hell", 4)

		declare ui_slider $SubSynthVol (0, 700000)
		make_persistent($SubSynthVol)
		declare $SubSynthVolId
		$SubSynthVolId := get_ui_id($SubSynthVol)
		set_control_par_str($SubSynthVolId, $CONTROL_PAR_PICTURE, "HoriSlider_256")
		set_control_par_str($SubSynthVol, $CONTROL_PAR_MOUSE_BEHAVIOUR, 1000)

		declare ui_slider $CreekVol (0, 700000)
		make_persistent($CreekVol)
		declare $CreekVolId
		$CreekVolId := get_ui_id($CreekVol)
		set_control_par_str($CreekVolId, $CONTROL_PAR_PICTURE, "HoriSlider_256")
		set_control_par_str($CreekVol, $CONTROL_PAR_MOUSE_BEHAVIOUR, 1000)

		declare ui_slider $SubSynthAttSlider(0,1000000)
		make_persistent($SubSynthAttSlider)
		declare $SubSynthAttSliderId
		$SubSynthAttSliderId := get_ui_id($SubSynthAttSlider)
		set_control_par_str($SubSynthAttSliderId, $CONTROL_PAR_PICTURE, "CompKnob")
   		set_control_par_str($SubSynthAttSliderId, $CONTROL_PAR_MOUSE_BEHAVIOUR, 1000)

		declare ui_slider $SubSynthDecSlider(0,1000000)
		make_persistent($SubSynthDecSlider)
		declare $SubSynthDecSliderId
		$SubSynthDecSliderId := get_ui_id($SubSynthDecSlider)
		set_control_par_str($SubSynthDecSliderId, $CONTROL_PAR_PICTURE, "CompKnob")
   		set_control_par_str($SubSynthDecSliderId, $CONTROL_PAR_MOUSE_BEHAVIOUR, 1000)


		declare ui_slider $SubSynthSusSlider(0,1000000)
		make_persistent($SubSynthSusSlider)
		declare $SubSynthSusSliderId
		$SubSynthSusSliderId := get_ui_id($SubSynthSusSlider)
		set_control_par_str($SubSynthSusSliderId, $CONTROL_PAR_PICTURE, "CompKnob")
   		set_control_par_str($SubSynthSusSliderId, $CONTROL_PAR_MOUSE_BEHAVIOUR, 1000)
			
		declare ui_slider $SubSynthRelSlider(0,1000000)
		make_persistent($SubSynthRelSlider)
		declare $SubSynthRelSliderId
		$SubSynthRelSliderId := get_ui_id($SubSynthRelSlider)
		set_control_par_str($SubSynthRelSliderId, $CONTROL_PAR_PICTURE, "CompKnob")
   		set_control_par_str($SubSynthRelSliderId, $CONTROL_PAR_MOUSE_BEHAVIOUR, 1000)

		declare ui_slider $LP(50000,1000000)
  		make_persistent($LP)
   		declare $LpId
   		$LpId := get_ui_id($LP)
   		set_control_par_str($LpId, $CONTROL_PAR_PICTURE, "CompKnob")
   		$LP := 1000000

   		declare ui_slider $HP(50000,1000000)
   		make_persistent($HP)
   		declare $HpId
   		$HpId := get_ui_id($HP)
   		set_control_par_str($HpId, $CONTROL_PAR_PICTURE, "CompKnob")
   		$HP := 50000

		declare declare ui_slider $SteroWidth(, max )

	{----Background----}

		make_perfview

   		set_script_title("Master FX/Sub/Creek")

		set_ui_height_px($UI_HEIGHT)
		set_ui_width_px($UI_WIDTH)
		set_ui_color($UI_COLOUR_HEX)

		set_control_par_str ($INST_WALLPAPER_ID, $CONTROL_PAR_PICTURE, "Background")
		set_skin_offset(888)

		message("")

end on

on ui_control($SubSynthVol)

	$i := $SUBSYNTH_GROUP_START

	while ($i <= $SUBSYNTH_GROUP_END)

        set_engine_par($ENGINE_PAR_VOLUME, $SubSynthVol, $i, 0, 0)
        inc($i)

    end while

	message("Synth Vol:" & $SubSynthVol)

	end on

on ui_control($CreekVol)
	
	set_engine_par($ENGINE_PAR_VOLUME, $CreekVol, 10, 0, 0)
	message("Creek Vol:" & $CreekVol)

	end on

{ UI callback, executed whenever the user changes the respective UI element }
on ui_control($SteroWidth)
	

	
end on

on note

 disallow_group($ALL_GROUPS)

	if ($SubSynthEnable = 1)

		if ($SubSynthDropdown = 0)

			allow_group(5)

		end if

		if ($SubSynthDropdown = 1)

			allow_group(6)

		end if

		if ($SubSynthDropdown = 2)

			allow_group(4)

		end if

		if ($SubSynthDropdown = 3)

			allow_group(7)

		end if

		if ($SubSynthDropdown = 4)

			allow_group(4)
			allow_group(5)
			allow_group(6)
			allow_group(7)

 		end if

	end if

	if ($CreekEnable = 1)

		allow_group(10)

	end if

	{ -- killswitch code -- }

    if ($EVENT_NOTE = 45)

        $KILLSWITCH_USED := 1

		$i := $SUBSYNTH_GROUP_START

		while ($i <= $SUBSYNTH_GROUP_END)

        set_engine_par($ENGINE_PAR_VOLUME, 0, $i, 0, 0)
        inc($i)

    	end while

     end if

	end on

on release

	if ($KILLSWITCH_USED = 1)

		$i := $SUBSYNTH_GROUP_START

		while ($i <= $SUBSYNTH_GROUP_END)

        set_engine_par($ENGINE_PAR_VOLUME, $SubSynthVol, $i, 0, 0)
        inc($i)

		$KILLSWITCH_USED := 0
    	end while

		
	end if

	end on