on init 

	{General UI Constants}
	declare const $UI_HEIGHT := 350
	declare const $UI_WIDTH := 633
	declare const $Y_OFFSET := 0
	declare const $X_OFFSET := 0
	declare const $UI_COLOUR_HEX := 934d8ddh  {Change this to the 6 character hex number of your chosen colour and leave the 9 at the start and h at the end (eg. 9<hex_code>h).}
	


	{ -- sub snyth stuff -- }

		declare const $SUBSYNTH_GROUP_START := 4

		declare const $SUBSYNTH_GROUP_END := 8

		declare $i

		declare $KILLSWITCH_USED

		declare ui_wavetable $SubSynthWave 

		declare ui_menu $SubSynthDropdown
		make_persistent($SubSynthDropdown)
		declare $SubSynthDropdownId
		$SubSynthDropdownId := get_ui_id($SubSynthDropdown)

		declare ui_button $SubSynthEnable
		declare $SubSynthEnableId
		$SubSynthEnableId := get_ui_id($SubSynthEnable)
		$SubSynthEnable := 1
		
		add_menu_item ($SubSynthDropdown, "Sine", 0)
		add_menu_item ($SubSynthDropdown, "Square", 1)
		add_menu_item ($SubSynthDropdown, "Saw", 2)
		add_menu_item ($SubSynthDropdown, "Triangle", 3)

		declare ui_slider $SubSynthVol (0, 700000)
		make_persistent($SubSynthVol)
		declare $SubSynthVolId
		$SubSynthVolId := get_ui_id($SubSynthVol)

		declare ui_slider $SubSynthAttSlider(0,1000000)
		make_persistent($SubSynthAttSlider)
		declare $SubSynthAttSliderId
		$SubSynthAttSliderId := get_ui_id($SubSynthAttSlider)

		declare ui_slider $SubSynthDecSlider(0,1000000)
		make_persistent($SubSynthDecSlider)
		declare $SubSynthDecSliderId
		$SubSynthDecSliderId := get_ui_id($SubSynthDecSlider)

		declare ui_slider $SubSynthSusSlider(0,1000000)
		make_persistent($SubSynthSusSlider)
		declare $SubSynthSusSliderId
		$SubSynthSusSliderId := get_ui_id($SubSynthSusSlider)
			
		declare ui_slider $SubSynthRelSlider(0,1000000)
		make_persistent($SubSynthRelSlider)
		declare $SubSynthRelSliderId
		$SubSynthRelSliderId := get_ui_id($SubSynthRelSlider)

		set_control_par(get_ui_id($SubSynthWave), $CONTROL_PAR_WT_ZONE, find_zone("Wavetable01")) { -- ???? gotta work out what this does -- }

	{----Background----}

		make_perfview

   		set_script_title("Master FX + Sub Synth")

		set_ui_height_px($UI_HEIGHT)
		set_ui_width_px($UI_WIDTH)
		set_ui_color($UI_COLOUR_HEX)

		set_control_par_str ($INST_WALLPAPER_ID, $CONTROL_PAR_PICTURE, "Background")
		set_skin_offset(888)

		message("")

end on

{ UI callback, executed whenever the user changes the respective UI element }
on ui_control($SubSynthDropdown)
	{your code here}
end on

on note

 disallow_group($ALL_GROUPS)

	if ($SubSynthEnable = 1)

		if ($SubSynthDropdown = 0)

			allow_group(5)

		end if



		if ($SubSynthDropdown = 2)

			allow_group(4)

		end if


 	end if

	{ -- killswitch code -- }

    if ($EVENT_NOTE = 45)

        $KILLSWITCH_USED := 1

        set_engine_par($ENGINE_PAR_VOLUME, 0, 2, -1, -1)
        set_engine_par($ENGINE_PAR_VOLUME, 0, 3, -1, -1)

     end if

end on

on ui_control($SubSynthVol)

	$i := $SUBSYNTH_GROUP_START

	while ($i <= $SUBSYNTH_GROUP_END)

        set_engine_par($ENGINE_PAR_VOLUME, $SubSynthVol, $i, 0, 0)
        inc($i)

    end while

end on
